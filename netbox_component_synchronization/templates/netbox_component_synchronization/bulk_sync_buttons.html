{% load static %}

<style>
.bulk-sync-buttons {
    margin-left: 10px;
}

.bulk-sync-buttons .dropdown-toggle {
    background-color: #6f42c1;
    border-color: #6f42c1;
    color: white;
}

.bulk-sync-buttons .dropdown-toggle:hover {
    background-color: #5e35a8;
    border-color: #5e35a8;
}

.bulk-sync-buttons .dropdown-menu {
    min-width: 200px;
}
</style>

{% if device and device.device_type %}
<div class="bulk-sync-buttons">
    <div class="dropdown">
        <button class="btn btn-purple btn-sm dropdown-toggle" type="button" id="bulkSyncDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="mdi mdi-sync" aria-hidden="true"></i> Bulk Sync
        </button>
        <ul class="dropdown-menu" aria-labelledby="bulkSyncDropdown">
            <li>
                <form method="post" action="{% url 'plugins:netbox_component_synchronization:bulk_sync' device_id=device.id component_type=component_type %}" style="display: inline;">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="add_missing">
                    <button type="submit" class="dropdown-item" onclick="return confirm('Add all missing components from device type template?')">
                        <i class="mdi mdi-plus text-success"></i> Add Missing Components
                    </button>
                </form>
            </li>
            <li>
                <form method="post" action="{% url 'plugins:netbox_component_synchronization:bulk_sync' device_id=device.id component_type=component_type %}" style="display: inline;">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="repair_out_of_sync">
                    <button type="submit" class="dropdown-item" onclick="return confirm('Repair name mismatches between device and template?')">
                        <i class="mdi mdi-wrench text-warning"></i> Repair Out of Sync
                    </button>
                </form>
            </li>
            <li>
                <form method="post" action="{% url 'plugins:netbox_component_synchronization:bulk_sync' device_id=device.id component_type=component_type %}" style="display: inline;">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="remove_out_of_sync">
                    <button type="submit" class="dropdown-item" onclick="return confirm('Remove components that don\'t exist in template?')">
                        <i class="mdi mdi-minus text-danger"></i> Remove Out of Sync
                    </button>
                </form>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
                <form method="post" action="{% url 'plugins:netbox_component_synchronization:bulk_sync' device_id=device.id component_type=component_type %}" style="display: inline;">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="sync_all">
                    <button type="submit" class="dropdown-item" onclick="return confirm('Perform complete synchronization (add missing, repair mismatches, remove extra)?')">
                        <i class="mdi mdi-sync-circle text-primary"></i> Sync All Components
                    </button>
                </form>
            </li>
        </ul>
    </div>
</div>
{% endif %}